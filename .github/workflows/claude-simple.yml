name: Claude Simple Integration

on:
  issues:
    types: [opened, labeled]
  issue_comment:
    types: [created]

permissions:
  issues: write

jobs:
  respond-to-claude:
    name: Respond to Claude
    runs-on: ubuntu-latest
    if: |
      (github.event_name == 'issues' && contains(github.event.issue.labels.*.name, 'claude')) ||
      (github.event_name == 'issue_comment' && contains(github.event.comment.body, '@claude'))
    
    steps:
    - name: Setup GitHub CLI
      run: |
        echo "Setting up GitHub CLI with default token..."
        
    - name: Respond to Issue
      env:
        GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      run: |
        echo "🤖 Processing Claude request..."
        
        if [[ "${{ github.event_name }}" == "issues" ]]; then
          ISSUE_NUMBER="${{ github.event.issue.number }}"
          
          gh issue comment $ISSUE_NUMBER \
            --repo ${{ github.repository }} \
            --body "🤖 **Claude 整合測試成功！**
            
已偵測到 \`claude\` 標籤。GitHub Actions 正常運作。

**建議的下一步：**
1. 開啟 [Claude.ai](https://claude.ai)
2. 貼上此 issue 的內容
3. 請 Claude 協助實作功能

---
*此訊息由 GitHub Actions 自動產生*"
            
        elif [[ "${{ github.event_name }}" == "issue_comment" ]]; then
          ISSUE_NUMBER="${{ github.event.issue.number }}"
          
          gh issue comment $ISSUE_NUMBER \
            --repo ${{ github.repository }} \
            --body "🤖 **已收到 @claude 提及！**
            
GitHub Actions 整合運作正常。請在 Claude.ai 中繼續對話。"
        fi