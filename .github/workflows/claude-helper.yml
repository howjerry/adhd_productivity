name: Claude Helper for Subscribers

on:
  issue_comment:
    types: [created]
  issues:
    types: [opened, labeled]

permissions:
  issues: write

jobs:
  claude-helper:
    runs-on: ubuntu-latest
    if: |
      (github.event_name == 'issue_comment' && contains(github.event.comment.body, '@claude')) ||
      (github.event_name == 'issues' && contains(github.event.issue.labels.*.name, 'claude'))
    
    steps:
    - name: Create Claude.ai Helper Message
      uses: actions/github-script@v7
      with:
        script: |
          const issueNumber = context.issue.number;
          const issueTitle = context.payload.issue.title;
          const issueBody = context.payload.issue.body;
          const issueUrl = context.payload.issue.html_url;
          
          let message = `## ğŸ¤– Claude åŠ©æ‰‹
          
          ç”±æ–¼æ‚¨æ˜¯ Claude Max è¨‚é–±æˆ¶ï¼Œè«‹ä½¿ç”¨ä»¥ä¸‹æ­¥é©Ÿï¼š
          
          ### 1. è¤‡è£½ä»¥ä¸‹å…§å®¹åˆ° Claude.aiï¼š
          
          \`\`\`
          GitHub Issue #${issueNumber}: ${issueTitle}
          é€£çµ: ${issueUrl}
          
          å…§å®¹:
          ${issueBody}
          
          è«‹å¹«æˆ‘ï¼š
          1. åˆ†æé€™å€‹ issue çš„éœ€æ±‚
          2. æä¾›å¯¦ä½œå»ºè­°æˆ–ç¨‹å¼ç¢¼
          3. è€ƒæ…® ADHD ä½¿ç”¨è€…çš„ç‰¹æ®Šéœ€æ±‚
          \`\`\`
          
          ### 2. åœ¨ Claude.ai ä¸­çš„å»ºè­°æç¤ºï¼š
          
          - "è«‹æ ¹æ“š ADHD ç”Ÿç”¢åŠ›ç³»çµ±çš„è¨­è¨ˆåŸå‰‡å¯¦ä½œé€™å€‹åŠŸèƒ½"
          - "è«‹ä½¿ç”¨ React + TypeScript å’Œ ASP.NET Core"
          - "è«‹ç¢ºä¿ç¬¦åˆç„¡éšœç¤™è¨­è¨ˆæ¨™æº–"
          
          ### 3. å°‡ Claude çš„å›æ‡‰è²¼å›é€™è£¡
          
          ç•¶æ‚¨å¾ Claude.ai ç²å¾—è§£æ±ºæ–¹æ¡ˆå¾Œï¼Œè«‹å°‡ç¨‹å¼ç¢¼æˆ–å»ºè­°è²¼å›æ­¤ issueã€‚
          
          ---
          *æ­¤è¨Šæ¯ç”± GitHub Actions è‡ªå‹•ç”¢ç”Ÿï¼Œå°ˆç‚º Claude Max è¨‚é–±æˆ¶è¨­è¨ˆ*`;
          
          await github.rest.issues.createComment({
            issue_number: issueNumber,
            owner: context.repo.owner,
            repo: context.repo.repo,
            body: message
          });